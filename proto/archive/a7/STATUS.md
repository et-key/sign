# プロトタイプ A7 (JavaScript 実装) 開発状況

現在のバージョン: 0.1.0

## 概要
A7は、手書きのLexer/ParserとASTベースのインタープリタを中心とした、Signプログラミング言語のJavaScript実装プロトタイプです。

## 実装済みの機能

### 1. Lexer (`lexer.js`)
- **トークン化**: 識別子、数値、文字列、演算子を正確に検出します。
- **空白処理**:
  - Pythonのようなブロック構造のための `INDENT`/`DEDENT` を処理します。
  - 空白を含んだ中置演算子（例: ` + `）と、密な演算子の区別が可能です。
  - 符号付き数値（例: `-5`）と減算（`- 5`）を区別します。

### 2. Parser (`parser.js`)
- **アルゴリズム**: Pratt Parsing (Top-Down Operator Precedence)。
- **機能**:
  - 前置、中置、後置演算子を正しく処理します。
  - 暗黙の隣接（関数適用）を高い優先順位でサポートします。
  - ブロック構文（`[...]`、インデントブロック）を構造化されたASTにパースします。
  - 「値としての演算子」（例: `[+]`）をサポートします。
  - 末尾演算子/セクション（例: `[+,]`）をサポートします（パースのみ、実行は限定的）。

### 3. Interpreter (`interpreter.js` & `runtime.js`)
- **実行モデル**: ASTの直接評価。
- **機能**:
  - **変数定義**: `x : 10` のような定義が正しく機能します。
  - **制御フロー**: `条件 : 値` という構文（ガードのような振る舞い）をサポートしています。
  - **算術演算**: 標準的な演算子（`+`, `-`, `*`, `/`, `^`, `%`）を実装済みです。
  - **比較演算**: 値を返す比較ロジック（`<`, `=` など）を実装済みです。
  - **環境**: ブロックや関数のためのネストされたスコープ変数をサポートしています。

## 制限事項と未実装機能

- **高度なリスト操作**:
  - Generator/Stream（プル型評価）は完全には実装されていません。リストは現在、正格なJavaScript配列として扱われます。
  - `map` (`[* 2,]`) や `fold` (`[+]`) の構文はパースされますが、ランタイムの動作は未実装です。
- **遅延評価**:
  - 論理演算子 `&` や `|` は現在、ランタイムで正格なJS演算子として実装されています（部分的な短絡評価のみ）。
- **高度な演算子**:
  - `'` (Get)、`~` (Range/Spread)、`$` (Address) などの演算子はパースされますが、完全なロジックは実装されていません。
- **モジュール**: インポート/エクスポートシステムは未実装です。

## 既知の問題
- 特定のコンテキストでの前置演算子が、`Parser.getPrefixHandler` で明示的に処理されていない場合、「Unknown operator」という警告が出ることがあります。
- 完全な関数合成のサポートがないため、複雑なネストされたリスト/関数（ポイントフリースタイル）は期待通りに評価されない可能性があります。
